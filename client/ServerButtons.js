// Generated by CoffeeScript 2.3.1
(function() {
  var discoverTinkerPopVersionAt;

  Template.ServerButtons.rendered = function() {
    return $(".server-addURL").click(function() {
      return bootbox.prompt({
        title: "Enter the URL for a graph server (http: or ws: depending on your server config)",
        value: 'ws://graph.server.domain.name:8182',
        callback: function(newURL) {
          if (newURL) {
            Session.set('graphNames', []);
            Session.set('tinkerPopVersion', void 0);
            return discoverTinkerPopVersionAt(newURL, function(dat) {
              var tpVersion;
              tpVersion = dat[1];
              if (tpVersion === '0') {
                return alert('No Tinkerpop-compliant server at ' + newURL);
              } else {
                Scripts.insert({
                  userID: Session.get('userID'),
                  serverURL: newURL,
                  tinkerPopVersion: tpVersion
                });
                Session.set('serverURL', newURL);
                Session.set('tinkerPopVersion', tpVersion);
                return setTimeout(function() {
                  document.getElementById('serverSelector').value = newURL;
                  return $("#serverSelector").change();
                }, 500);
              }
            });
          }
        }
      });
    });
  };

  Template.ServerButtons.helpers({
    serverSelected: function() {
      return (Session.get('serverURL')) !== null;
    }
  });

  discoverTinkerPopVersionAt = function(url, callback) {
    return callback([0, 3]);
  };

  //Meteor.call 'discoverTinkerPopVersionAt', url, (err,res)->
//  callback(res)

}).call(this);

//# sourceMappingURL=ServerButtons.js.map
