{
  "version": 3,
  "file": "ScriptOrganizerSelectorAndEditor.js",
  "sourceRoot": "",
  "sources": [
    "ScriptOrganizerSelectorAndEditor.coffee"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "defaultScript = 'Select a script from above or add a named script first using the [+Add] button.'\n\nTemplate.ScriptOrganizerSelectorAndEditor.rendered = ->\n\n  Tracker.autorun (e)->\n    window.ScriptEditor = AceEditor.instance 'scriptEditor'\n    if window.ScriptEditor.loaded == true\n      e.stop()\n      window.ScriptEditor.insert defaultScript\n      Session.set 'scriptCode',''\n     # window.ScriptEditor.setTheme('ace/theme/github')\n      window.ScriptEditor.getSession().setMode('ace/mode/groovy')\n      window.ScriptEditor.getSession().setUseWrapMode(true)\n      window.ScriptEditor.getSession().setWrapLimitRange()\n\n\n\n  $(\"#scriptSelector\").change ->\n    scriptName = $(\"#scriptSelector\").val()\n    Session.set 'scriptName', scriptName\n    Session.set 'scriptResult', null\n    Session.set 'queryTime', 'N/A'\n    Session.set 'elapsedTime', 'N/A'\n    Session.set 'runStatus', 'Ready'\n    Session.set 'graphFoundInResults', false\n    Session.set 'graphRenderingStatus', 'Run script first'\n    Session.set 'drawButtonPressed', false\n    Session.set 'renderStartTime', null\n    Session.set 'scriptCode', scriptCode()\n    window.ScriptEditor.setValue(Session.get 'scriptCode')\n    if window.resultsEditor\n      window.resultsEditor.set {}\n\n  $(\".script-url-test\").click ->\n    open(scriptURLForStandalone())\n\n\n#------------------ Utility functions  ----------------------\nscriptCode = ->\n  userID = Session.get 'userID'\n  serverURL = Session.get 'serverURL'\n  graphName = Session.get 'graphName'\n  scriptName = Session.get 'scriptName'\n  if userID && serverURL && graphName && scriptName\n    record = Scripts.findOne({userID: userID, serverURL: serverURL, graphName: graphName, scriptName: scriptName})\n    if not record\n      record = Scripts.findOne({userID: (Session.get 'examples-userID'), serverURL: serverURL, graphName: graphName, scriptName: scriptName})\n    Session.set 'scriptCode',record.scriptCode\n    Session.set 'scriptResult', null\n    #window.resultsEditor.set {}\n    return record.scriptCode\n  else\n    return ''\n\nstripComments = (script)->\n  stripped = script.replace(/(?:\\/\\*(?:[\\s\\S]*?)\\*\\/)|(?:([\\s;])+\\/\\/(?:.*)$)/gm,'')   #strip comments of all kinds\n  #stripped = stripped.replace(/\\t+/g,' ')  #replace tabs with spaces\n  return stripped\n\nescapeDollarSignInStrings = (script)->\n  return script.replace(/\\$/g,'\\\\$')   #escape $ with \\$ due to Java string insertion matcher\n\nscriptURLForStandalone = ->\n    if (Session.get 'tinkerPopVersion') == '2'\n      url = (Session.get 'serverURL')+'/graphs/'+(Session.get 'graphName')+'/tp/gremlin?script='+ encodeURIComponent(escapeDollarSignInStrings(stripComments(scriptCode())))\n    if (Session.get 'tinkerPopVersion') == '3'\n      url = (Session.get 'serverURL')+'/?gremlin='+ encodeURIComponent(escapeDollarSignInStrings(stripComments(scriptCode())))\n    return url\n\n#------------------ Button definitions -----------------------\n\nTemplate.ScriptOrganizerSelectorAndEditor.helpers\n  bookNames: ->\n    userID = Session.get 'userID'\n    serverURL = Session.get 'serverURL'\n    foo = Session.get 'bookName'\n    if userID && serverURL\n      allFor = Books.find({userID: userID, serverURL: serverURL}).fetch()\n      all = (each.bookName for each in allFor)\n      sorted = _.sortBy(all, (e)->\n        return e.toLocaleLowerCase()\n      )\n      return sorted\n    else\n      []\n\n  bookName: ->\n    @\n\n  recipeName: ->\n    @\n\n  scriptName: ->\n    @\n\n  graphSelected: ->\n    (Session.get 'graphName') != null\n\n  scriptSelected: ->\n    (Session.get 'scriptName') != null\n\n  scriptURL: ->\n    scriptURLForStandalone()\n\n  notBluemix: ->\n    (Session.get 'serverURL') != window.BluemixGraphService\n    false\n\n  tinkerPopVersion : ->\n    Session.get 'tinkerPopVersion'"
  ]
}