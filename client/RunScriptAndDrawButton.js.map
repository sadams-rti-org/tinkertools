{
  "version": 3,
  "file": "RunScriptAndDrawButton.js",
  "sourceRoot": "",
  "sources": [
    "RunScriptAndDrawButton.coffee"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "Template.RunScriptAndDrawButton.rendered = ->\n  #------------------ functions ----------------------\n\n  #------------------ Button definitions -----------------------\n\n  $(\".script-run\").click ->\n    Session.set 'graphFoundInResults', false\n    serverURL = Session.get 'serverURL'\n    graphName = Session.get 'graphName'\n    scriptName = Session.get 'scriptName'\n    userID = Session.get 'userID'\n    Session.set 'runStatus','Running...'\n    Session.set 'queryTime','Timing...'\n    Session.set 'graphFoundInResults', false\n    Session.set 'graphRenderingStatus', ''\n    Session.set 'elapsedRenderTime', ''\n    Session.set 'elapsedTime','Timing...'\n    Session.set 'drawButtonPressed', false\n    Session.set 'startTime', moment().toDate()\n    Session.set 'scriptResult', null\n    Session.set 'elementsInResults',{vertices:[],edges:[]}\n    if window.resultsEditor\n      window.resultsEditor.set {}\n    if serverURL && graphName && scriptName\n      if window.ScriptEditor != undefined\n        scriptCode = window.ScriptEditor.getValue()\n      else\n        scriptCode = Session.get 'scriptCode'\n    if (Session.get \"usingWebSockets\")\n      window.socketToJanus.onmessage = (msg) ->\n        endTime = Date.now()\n        data = msg.data\n        json = JSON.parse(data)\n        if json.status.code >= 500\n          alert \"Error in processing Gremlin script: \"+json.status.message\n        else\n          if json.status.code == 204\n            results = []\n          else\n            results = json.result.data\n          callback(results)\n      request =\n        requestId: uuid.new(),\n        op:\"eval\",\n        processor:\"\",\n        args:{gremlin: scriptCode, bindings: {}, language: \"gremlin-groovy\"}\n      startTime = Date.now()\n      window.socketToJanus.send(JSON.stringify(request))\n    else\n      Meteor.call \"runScript\", userID, serverURL,(Session.get 'tinkerPopVersion'), (Session.get \"usingWebSockets\"), scriptName,scriptCode, {}, (error, result) ->\n        if error\n          console.log  error\n          alert JSON.stringify error\n          return\n        #console.log 'result=',JSON.stringify result\n        if (result == undefined) || (result.results == undefined) || (result.results == null) || (result.results.length == 0)\n          results = [null]\n        else\n          results = result.results\n        if window.resultsEditor\n          window.resultsEditor.set results\n        Session.set 'scriptResult', results\n        Session.set 'runStatus', result.success\n        d = moment.duration(Math.round(result.queryTime*1000)/1000)\n        Session.set 'queryTime', window.durationToString(d)\n        d = moment.duration(Math.round((moment()-moment(Session.get 'startTime'))*1000)/1000)\n        Session.set 'elapsedTime', window.durationToString(d)\n        determineGraphToShow()\n        Session.set 'drawButtonPressed', true\n        Session.set 'graphRenderingStatus','Rendering...'\n        Session.set 'elapsedRenderTime', 'Timing...'\n        randomizeLayout()\n        renderGraph()\n      return\n    return\n\n\n\nTemplate.RunScriptAndDrawButton.helpers\n  scriptSelected: ->\n    (Session.get 'scriptName') != null\n\n  scriptResult: ->\n    (Session.get 'scriptResult') != null\n\n  runStatus: ->\n    status = Session.get 'runStatus'\n    if status == true\n      return 'Succeeded'\n    if status == false\n      return 'Failed'\n    return status\n\n  queryTime: ->\n    t = Session.get 'queryTime'\n    if t == 'N/A'\n      return t\n    else\n      return t\n\n  elapsedTime: ->\n    t = Session.get 'elapsedTime'\n    if t == 'N/A'\n      return t\n    else\n      return t\n\n\nwindow.durationToString = (d)->\n  qt = ''\n  if d.hours()\n    qt = qt+d.hours()+'h'\n  if d.minutes()\n    qt = qt+d.minutes()+'m'\n  if d.seconds()\n    qt = qt+d.seconds()+'s'\n  if d.milliseconds()\n    qt = qt+(Math.round(d.milliseconds()))+'ms'\n  return qt"
  ]
}